<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>لوحة المحتاج</title>
    <!-- Normalize  File  -->
    <link rel="stylesheet" href="css/normalize.css">
    <!-- Google Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Arabic:wght@300;400;500;600;700&family=Open+Sans:wdth,wght@75..100,300..800&display=swap" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>

    <!-- CSS File -->
    <link rel="stylesheet" href="css/header&footer.css">
    <!-- <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script> -->
    <link rel="stylesheet" href="css/needy-dashboard.css">
    <style>
    body {
      font-family: 'Cairo', sans-serif;
    }
    .header {
      background-color: #1A6C9E;
      color: white;
      padding: 15px 30px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-radius: 0 0 12px 12px;
    }
    .user-info {
      display: flex;
      flex-direction: column;
    }
    .user-info span {
      font-size: 14px;
      color: #e0e0e0;
    }
    .notification-icon {
      position: relative;
      cursor: pointer;
    }
    .notification-icon i {
      font-size: 22px;
      color: white;
    }
    .notification-dropdown {
      display: none;
      position: absolute;
      top: 35px;
      left: 0;
      background: white;
      width: 280px;
      max-height: 300px;
      overflow-y: auto;
      border-radius: 10px;
      box-shadow: 0 6px 12px rgba(0,0,0,0.15);
      z-index: 10;
    }
    .notification-dropdown.active {
      display: block;
    }
    .notification-dropdown .notification {
      margin: 8px;
    }
    .notification-header {
      display: flex;
      justify-content: flex-end;
      padding: 10px;
    }
    .no-notification {
      padding: 20px;
      text-align: center;
      color: gray;
    }
  </style>
</head>
<body>
  <div class="dashboard-container">
    <div class="header">
        <div class="user-info">
            <strong id="needy-name">المستخدم</strong>
            <span id="needy-email">email@example.com</span>
        </div>

        <div class="notification-wrapper">
            <button id="notification-toggle" class="notification-icon">
                <i class="fas fa-bell"></i>
            </button>
            <div class="notification-dropdown" id="notification-dropdown">
                    <!-- <div class="notification">
                    تم قبول طلبك بنجاح.
                    <span>قبل دقيقة واحدة</span>
                    <button class="delete-btn" onclick="this.parentElement.remove()">×</button>
                </div> -->
                <div class="notification-header">
                    <button id="clear-notifications">مسح الكل 🗑️</button>
                </div>
                الإشعارات ستُضاف هنا 
            </div>
        </div>
    </div>


    <div class="card-grid">
      <div class="dashboard-card clickable"  onclick="location.href='my-request.htm'">
        <h3>طلباتي السابقة</h3>
        <p>عرض ومتابعة جميع طلبات المساعدة</p>
      </div>
      <div class="dashboard-card clickable"  onclick="location.href='request-help.htm'">
        <h3>إرسال طلب جديد</h3>
        <p>املأ النموذج لطلب مساعدة جديدة</p>
      </div>
      <div class="dashboard-card clickable">
        <h3>التبرعات المستلمة</h3>
        <p id="donation-total">0 شيكل</p>
       </div>
        <div class="dashboard-card clickable" onclick="location.href='withdraw-request.html'">
            <h3>طلب سحب مبلغ</h3>
            <p>اسحب رصيدك المتوفر نقدًا أو عبر البنك</p>
        </div>
      <div class="dashboard-card clickable">
        <h3>الإعدادات</h3>
        <p>تحديث بيانات الحساب</p>
      </div>
      <div class="dashboard-card clickable" onclick="location.href='how.htm'">
        <h3>تواصل معنا</h3>
        <p>الدعم والمساعدة</p>
      </div>
    </div>
  </div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/js/all.min.js"></script>
<!--  هذا فقط لظهور الااشعارات  -->
  <!-- <script>
    const toggleButton = document.getElementById("notification-toggle");
    const dropdown = document.getElementById("notification-dropdown");
    const clearButton = document.getElementById("clear-notifications");

    toggleButton.addEventListener("click", () => {
      dropdown.style.display = dropdown.style.display === "block" ? "none" : "block";
    });

    clearButton.addEventListener("click", () => {
      dropdown.innerHTML = "<p style='text-align:center; color:#999;'>لا توجد إشعارات.</p>";
    });

    window.addEventListener("click", function(e) {
      if (!e.target.closest(".notification-wrapper")) {
        dropdown.style.display = "none";
      }
    });
  </script> -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
    // استرداد الاسم والبريد من localStorage 
    const name = localStorage.getItem("userName") || "مستخدم";
    const email = localStorage.getItem("tempEmail") || "email@example.com";
    // عرض الاسم والبريد في الصفحة 
    document.getElementById("needy-name").textContent = name;
    document.getElementById("needy-email").textContent = email;

    //   const donations = JSON.parse(localStorage.getItem("donations")) || [];
    //   const total = donations
    //     .filter((d) => d.needyEmail === email)
    //     .reduce((sum, d) => sum + d.amount, 0);
    // للمبلغ 
    let total = localStorage.getItem("totalDonation")
    document.getElementById("donation-total").textContent = total + " شيكل";
    // إشعارات تجريبية (مرة واحدة فقط) 

    const sampleNotifications = [
        { message: "تمت الموافقة على طلب المساعدة رقم 124", date: "2025-05-15" },
        { message: "وصلك تبرع بقيمة 150 شيكل", date: "2025-05-14" },
        { message: "طلب السحب قيد المراجعة", date: "2025-05-13" },
    ];

      if (!localStorage.getItem("needyNotifications")) {
        localStorage.setItem("needyNotifications", JSON.stringify(sampleNotifications));
      }

      let notifications = JSON.parse(localStorage.getItem("needyNotifications")) || [];
      const notificationList = document.getElementById("notification-dropdown");

      function renderNotifications() {
        const list = notificationList;
        list.innerHTML = '<div class="notification-header"><button id="clear-notifications">مسح الكل</button></div>';

        if (notifications.length === 0) {
          list.innerHTML += '<div class="no-notification">لا توجد إشعارات حالياً.</div>';
          return;
        }

        notifications.forEach((n, index) => {
          const div = document.createElement("div");
          div.className = "notification";
          div.innerHTML = `
            <p>${n.message}</p>
            <span>${n.date}</span>
            <button class="delete-btn" data-index="${index}">×</button>
          `;
          list.appendChild(div);
        });

        list.querySelectorAll(".delete-btn").forEach((btn) => {
          btn.addEventListener("click", (e) => {
            const i = e.target.dataset.index;
            notifications.splice(i, 1);
            localStorage.setItem("needyNotifications", JSON.stringify(notifications));
            renderNotifications();
          });
        });

        document.getElementById("clear-notifications").addEventListener("click", () => {
          if (confirm("هل أنت متأكد من حذف جميع الإشعارات؟")) {
            notifications = [];
            localStorage.removeItem("needyNotifications");
            renderNotifications();
          }
        });
      }

      renderNotifications();

      const bell = document.getElementById("notification-bell");
      bell.addEventListener("click", () => {
        document.getElementById("notifications").classList.toggle("active");
      });
    });
  </script>

</body>
</html>



